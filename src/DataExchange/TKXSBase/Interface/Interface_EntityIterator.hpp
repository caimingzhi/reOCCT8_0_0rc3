#pragma once


#include <Standard.hpp>
#include <Standard_DefineAlloc.hpp>
#include <Standard_Handle.hpp>

#include <Standard_Transient.hpp>
#include <NCollection_Sequence.hpp>
#include <NCollection_HSequence.hpp>
#include <Standard_Type.hpp>
#include <Standard_Boolean.hpp>
#include <Standard_Integer.hpp>
class Interface_IntVal;
class Standard_Transient;

//! Defines an Iterator on Entities.
//! Allows considering of various criteria
class Interface_EntityIterator
{
public:
  DEFINE_STANDARD_ALLOC

  //! Defines an empty iterator (see AddList & AddItem)
  Standard_EXPORT Interface_EntityIterator();

  //! Defines an iterator on a list, directly i.e. without copying it
  Standard_EXPORT Interface_EntityIterator(
    const occ::handle<NCollection_HSequence<occ::handle<Standard_Transient>>>& list);

  //! Gets a list of entities and adds its to the iteration list
  Standard_EXPORT void AddList(
    const occ::handle<NCollection_HSequence<occ::handle<Standard_Transient>>>& list);

  //! Adds to the iteration list a defined entity
  Standard_EXPORT void AddItem(const occ::handle<Standard_Transient>& anentity);

  //! same as AddItem (kept for compatibility)
  Standard_EXPORT void GetOneItem(const occ::handle<Standard_Transient>& anentity);

  //! Selects entities with are Kind of a given type, keep only
  //! them (is keep is True) or reject only them (if keep is False)
  Standard_EXPORT void SelectType(const occ::handle<Standard_Type>& atype, const bool keep);

  //! Returns count of entities which will be iterated on
  //! Calls Start if not yet done
  Standard_EXPORT int NbEntities() const;

  //! Returns count of entities of a given type (kind of)
  Standard_EXPORT int NbTyped(const occ::handle<Standard_Type>& type) const;

  //! Returns the list of entities of a given type (kind of)
  Standard_EXPORT Interface_EntityIterator Typed(const occ::handle<Standard_Type>& type) const;

  //! Allows re-iteration (useless for the first iteration)
  Standard_EXPORT virtual void Start() const;

  //! Says if there are other entities (vertices) to iterate
  //! the first time, calls Start
  Standard_EXPORT bool More() const;

  //! Sets iteration to the next entity (vertex) to give
  Standard_EXPORT void Next() const;

  //! Returns the current Entity iterated, to be used by Interface
  //! tools
  Standard_EXPORT const occ::handle<Standard_Transient>& Value() const;

  //! Returns the content of the Iterator, accessed through a Handle
  //! to be used by a frontal-engine logic
  //! Returns an empty Sequence if the Iterator is empty
  //! Calls Start if not yet done
  Standard_EXPORT occ::handle<NCollection_HSequence<occ::handle<Standard_Transient>>> Content()
    const;

  //! Clears data of iteration
  Standard_EXPORT void Destroy();

  //! Destructor
  Standard_EXPORT virtual ~Interface_EntityIterator();

protected:
  //! Allows subclasses of EntityIterator to reevaluate an iteration
  Standard_EXPORT void Reset();

private:
  occ::handle<Interface_IntVal>                                       thecurr;
  occ::handle<NCollection_HSequence<occ::handle<Standard_Transient>>> thelist;
};

